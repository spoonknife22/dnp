{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Samsung\\\\code\\\\cacp\\\\client\\\\components\\\\modals\\\\NominationModal.js\",\n    _s = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport NominationForm from '../forms/NominationForm';\nimport { connect } from 'react-redux';\nimport Web3 from 'web3';\nimport ProposalForm from '../forms/ProposalForm';\n\nconst NominationModal = ({\n  parcel,\n  props,\n  userManaBalance,\n  getCurrentProp\n}) => {\n  _s();\n\n  const drizzleState = props.drizzleState,\n        drizzle = props.drizzle;\n\n  const _useState = useState(false),\n        show = _useState[0],\n        setShow = _useState[1];\n\n  const handleShow = () => setShow(true);\n\n  const handleClose = () => setShow(false);\n\n  const _useState2 = useState(null),\n        tokenId = _useState2[0],\n        setTokenId = _useState2[1];\n\n  const _useState3 = useState(null),\n        currentProp = _useState3[0],\n        setCurrentProp = _useState3[1];\n\n  const myHeaders = new Headers();\n  myHeaders.append(\"Content-Type\", \"application/json\");\n  useEffect(() => {\n    const fetchDetailsLink = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var graphql, proxyUrl, targetUrl;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              graphql = JSON.stringify({\n                query: \"{ parcels(where: {x:\\\"\".concat(parcel.x, \"\\\",y:\\\"\").concat(parcel.y, \"\\\"}) { tokenId }}\")\n              });\n              proxyUrl = 'https://cors-anywhere.herokuapp.com/', targetUrl = 'https://api.thegraph.com/subgraphs/name/decentraland/marketplace';\n              fetch(proxyUrl + targetUrl, {\n                method: \"POST\",\n                headers: myHeaders,\n                body: graphql,\n                variables: {},\n                redirect: 'follow'\n              }).then(res => res.json()).then(result => {\n                const parcelData = result.data.parcels[0];\n                return parcelData;\n              }).then(result => {\n                const tokenId = result.tokenId;\n                setTokenId(tokenId);\n                return tokenId;\n              }).then( /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(tokenId) {\n                  var proposalAddress;\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return drizzle.contracts.ProposalController.methods.getPropTokenIdMap(\"\".concat(tokenId)).call();\n\n                      case 2:\n                        proposalAddress = _context.sent;\n                        getCurrentProp(proposalAddress);\n                        setCurrentProp(proposalAddress);\n\n                      case 5:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }, _callee);\n                }));\n\n                return function (_x) {\n                  return _ref2.apply(this, arguments);\n                };\n              }());\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }));\n\n      return function fetchDetailsLink() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchDetailsLink();\n  }, []);\n  return __jsx(React.Fragment, null, __jsx(\"button\", {\n    type: \"button\",\n    onClick: handleShow,\n    className: \"jsx-44712451\" + \" \" + \"btn btn-lg btn-block card-footer-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, \"Nominate Asset\"), __jsx(Modal, {\n    className: \"nomintation-modal\",\n    show: show,\n    onHide: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    className: \"text-center justify-content-center\",\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    className: \"text-center justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }, \"Current Price:\\xA0\", parcel.publication.price, \"\\xA0MANA\", __jsx(\"p\", {\n    className: \"jsx-44712451\" + \" \" + \"mana-balance mb-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  }, \"Your MANA Balance:\\xA0\", \"\".concat(userManaBalance)))), __jsx(Modal.Body, {\n    className: \"pt-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 11\n    }\n  }, __jsx(ProposalForm, {\n    assetPrice: parcel.publication.price,\n    props: props,\n    drizzle: drizzle,\n    drizzleState: drizzleState,\n    tokenId: tokenId,\n    userManaBalance: userManaBalance,\n    propasalContractAddr: currentProp,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }))), __jsx(_JSXStyle, {\n    id: \"44712451\",\n    __self: this\n  }, \".nomintation-modal.jsx-44712451{font-family:Poppins;}.mana-balance.jsx-44712451{font-size:.9rem;color:#66a3ff;font-weight:200;text-align:left;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcU2Ftc3VuZ1xcY29kZVxcY2FjcFxcY2xpZW50XFxjb21wb25lbnRzXFxtb2RhbHNcXE5vbWluYXRpb25Nb2RhbC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFtRlcsQUFDeUMsQUFDRSxnQkFBYSxJQURkLFVBQzhCLGdCQUFjLGdCQUFDIiwiZmlsZSI6IkM6XFxVc2Vyc1xcU2Ftc3VuZ1xcY29kZVxcY2FjcFxcY2xpZW50XFxjb21wb25lbnRzXFxtb2RhbHNcXE5vbWluYXRpb25Nb2RhbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiAgXHJcbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgTW9kYWwgZnJvbSAncmVhY3QtYm9vdHN0cmFwL01vZGFsJztcclxuaW1wb3J0IE5vbWluYXRpb25Gb3JtIGZyb20gJy4uL2Zvcm1zL05vbWluYXRpb25Gb3JtJztcclxuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JztcclxuaW1wb3J0IFdlYjMgZnJvbSAnd2ViMyc7XHJcbmltcG9ydCBQcm9wb3NhbEZvcm0gZnJvbSAnLi4vZm9ybXMvUHJvcG9zYWxGb3JtJztcclxuXHJcblxyXG5jb25zdCBOb21pbmF0aW9uTW9kYWwgPSAoeyBwYXJjZWwsIHByb3BzLCB1c2VyTWFuYUJhbGFuY2UsIGdldEN1cnJlbnRQcm9wIH0pID0+IHtcclxuXHJcbiAgY29uc3Qge2RyaXp6bGVTdGF0ZSwgZHJpenpsZX0gPSBwcm9wcztcclxuXHJcbiAgY29uc3QgW3Nob3csIHNldFNob3ddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IGhhbmRsZVNob3cgPSAoKSA9PiBzZXRTaG93KHRydWUpO1xyXG4gIGNvbnN0IGhhbmRsZUNsb3NlID0gKCkgPT4gc2V0U2hvdyhmYWxzZSk7XHJcbiAgY29uc3QgW3Rva2VuSWQsIHNldFRva2VuSWRdID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2N1cnJlbnRQcm9wLCBzZXRDdXJyZW50UHJvcF0gPSB1c2VTdGF0ZShudWxsKTtcclxuXHJcbiAgY29uc3QgbXlIZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcclxuICBteUhlYWRlcnMuYXBwZW5kKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICBjb25zdCBmZXRjaERldGFpbHNMaW5rID0gYXN5bmMgKCkgPT4ge1xyXG5cclxuICBjb25zdCBncmFwaHFsPSBKU09OLnN0cmluZ2lmeSh7IHF1ZXJ5OiBcclxuICBgeyBwYXJjZWxzKHdoZXJlOiB7eDpcIiR7cGFyY2VsLnh9XCIseTpcIiR7cGFyY2VsLnl9XCJ9KSB7IHRva2VuSWQgfX1gXHJcbn0pXHJcblxyXG4gIGNvbnN0IHByb3h5VXJsID0gJ2h0dHBzOi8vY29ycy1hbnl3aGVyZS5oZXJva3VhcHAuY29tLycsXHJcbiAgdGFyZ2V0VXJsID0gJ2h0dHBzOi8vYXBpLnRoZWdyYXBoLmNvbS9zdWJncmFwaHMvbmFtZS9kZWNlbnRyYWxhbmQvbWFya2V0cGxhY2UnXHJcblxyXG4gIGZldGNoKHByb3h5VXJsICsgdGFyZ2V0VXJsLCB7XHJcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgaGVhZGVyczpteUhlYWRlcnMsICBcclxuICAgIGJvZHk6Z3JhcGhxbCwgdmFyaWFibGVzOnt9LFxyXG4gICAgcmVkaXJlY3Q6ICdmb2xsb3cnXHJcbiAgfSlcclxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBjb25zdCBwYXJjZWxEYXRhID0gcmVzdWx0LmRhdGEucGFyY2Vsc1swXTtcclxuICAgICAgcmV0dXJuIHBhcmNlbERhdGE7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4geyBcclxuICAgICAgY29uc3QgeyB0b2tlbklkIH0gPSByZXN1bHQ7XHJcbiAgICAgc2V0VG9rZW5JZCh0b2tlbklkKTtcclxuICAgICByZXR1cm4gdG9rZW5JZDtcclxuICAgIH0pXHJcbiAgICAudGhlbihhc3luYyAodG9rZW5JZCkgPT4ge1xyXG4gICAgICBjb25zdCBwcm9wb3NhbEFkZHJlc3MgPSBhd2FpdCBkcml6emxlLmNvbnRyYWN0cy5Qcm9wb3NhbENvbnRyb2xsZXIubWV0aG9kcy5nZXRQcm9wVG9rZW5JZE1hcChgJHt0b2tlbklkfWApLmNhbGwoKTsgXHJcbiAgICAgIGdldEN1cnJlbnRQcm9wKHByb3Bvc2FsQWRkcmVzcyk7XHJcbiAgICAgIHNldEN1cnJlbnRQcm9wKHByb3Bvc2FsQWRkcmVzcyk7XHJcbiAgICB9KVxyXG4gIH07XHJcbmZldGNoRGV0YWlsc0xpbmsoKTtcclxuXHJcbn0sIFtdKTtcclxuXHJcblxyXG5yZXR1cm4gKCAgIFxyXG4gICAgICA8PiBcclxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzc05hbWU9XCJidG4gYnRuLWxnIGJ0bi1ibG9jayBjYXJkLWZvb3Rlci1idG5cIiBvbkNsaWNrPXtoYW5kbGVTaG93fT5cclxuICAgICAgICAgIE5vbWluYXRlIEFzc2V0XHJcbiAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgPE1vZGFsIGNsYXNzTmFtZT1cIm5vbWludGF0aW9uLW1vZGFsXCIgc2hvdz17c2hvd30gb25IaWRlPXtoYW5kbGVDbG9zZX0+XHJcbiAgICAgICAgICA8TW9kYWwuSGVhZGVyIGNsYXNzTmFtZT1cInRleHQtY2VudGVyIGp1c3RpZnktY29udGVudC1jZW50ZXJcIiBjbG9zZUJ1dHRvbj5cclxuICAgICAgICAgICAgPE1vZGFsLlRpdGxlIGNsYXNzTmFtZT1cInRleHQtY2VudGVyIGp1c3RpZnktY29udGVudC1jZW50ZXJcIj5DdXJyZW50IFByaWNlOiZuYnNwO3twYXJjZWwucHVibGljYXRpb24ucHJpY2V9Jm5ic3A7TUFOQVxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtYW5hLWJhbGFuY2UgbWItMVwiID5Zb3VyIE1BTkEgQmFsYW5jZTombmJzcDt7YCR7dXNlck1hbmFCYWxhbmNlfWB9PC9wPlxyXG4gICAgICAgICAgPC9Nb2RhbC5UaXRsZT5cclxuICAgICAgICA8L01vZGFsLkhlYWRlcj5cclxuICAgICAgICAgIDxNb2RhbC5Cb2R5IGNsYXNzTmFtZT1cInB0LTFcIj5cclxuICAgICAgICAgIDxQcm9wb3NhbEZvcm0gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgYXNzZXRQcmljZT17cGFyY2VsLnB1YmxpY2F0aW9uLnByaWNlfSAgXHJcbiAgICAgICAgICAgIHByb3BzPXtwcm9wc31cclxuICAgICAgICAgICAgZHJpenpsZT17ZHJpenpsZX1cclxuICAgICAgICAgICAgZHJpenpsZVN0YXRlPXtkcml6emxlU3RhdGV9XHJcbiAgICAgICAgICAgIHRva2VuSWQ9e3Rva2VuSWR9XHJcbiAgICAgICAgICAgIHVzZXJNYW5hQmFsYW5jZT17dXNlck1hbmFCYWxhbmNlfVxyXG4gICAgICAgICAgICBwcm9wYXNhbENvbnRyYWN0QWRkcj17Y3VycmVudFByb3B9XHJcbiAgICAgICAgICAgIC8+IFxyXG4gICAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICAgIDwvTW9kYWw+XHJcbiAgICAgICAgPHN0eWxlIGpzeD5cclxuICAgICAgICAgIHtgICAubm9taW50YXRpb24tbW9kYWx7Zm9udC1mYW1pbHk6IFBvcHBpbnM7fVxyXG4gICAgICAgICAgICAgIC5tYW5hLWJhbGFuY2V7Zm9udC1zaXplOi45cmVtO2NvbG9yOiM2NmEzZmY7Zm9udC13ZWlnaHQ6IDIwMDt0ZXh0LWFsaWduOmxlZnR9XHJcbiAgICAgICAgICBgfSAgICAgICAgICAgICAgICBcclxuICAgICAgICA8L3N0eWxlPlxyXG4gICAgICA8Lz5cclxuICAgICAgICApOyAgICBcclxuICAgICAgfSBcclxuICAgICAgICBjb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGUpID0+ICh7XHJcbiAgICAgICAgICBwcm9wQWRkcmVzczogc3RhdGUuYXBwUmVkdWNlcnMucHJvcEFkZHJlc3MsXHJcbiAgICAgICAgfSlcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBtYXBEaXNwYXRjaFRvUHJvcHMgPSAoZGlzcGF0Y2gpID0+ICh7XHJcbiAgICAgICAgICBnZXRDdXJyZW50UHJvcDogKHByb3Bvc2FsQWRkcmVzcykgPT4gIGRpc3BhdGNoKHsgdHlwZTogXCJHT1RfUFJPUF9BRERSRVNTXCIsIHByb3Bvc2FsQWRkcmVzczpwcm9wb3NhbEFkZHJlc3MgfSksXHJcbiAgICAgICAgICBnZXRUb2tlbklkOiAodG9rZW5JZCkgPT4gIGRpc3BhdGNoKHsgdHlwZTogXCJTRVRfVE9LRU5fSURcIiwgdG9rZW5JZDp0b2tlbklkIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKE5vbWluYXRpb25Nb2RhbCk7XHJcbiAgICAgIl19 */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\Samsung\\\\\\\\code\\\\\\\\cacp\\\\\\\\client\\\\\\\\components\\\\\\\\modals\\\\\\\\NominationModal.js */\"));\n};\n\n_s(NominationModal, \"a5H9PBTLK8/6A8+aPI9RDy2zqM0=\");\n\n_c = NominationModal;\n\nconst mapStateToProps = state => ({\n  propAddress: state.appReducers.propAddress\n});\n\nconst mapDispatchToProps = dispatch => ({\n  getCurrentProp: proposalAddress => dispatch({\n    type: \"GOT_PROP_ADDRESS\",\n    proposalAddress: proposalAddress\n  }),\n  getTokenId: tokenId => dispatch({\n    type: \"SET_TOKEN_ID\",\n    tokenId: tokenId\n  })\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NominationModal);\n\nvar _c;\n\n$RefreshReg$(_c, \"NominationModal\");","map":{"version":3,"sources":["C:/Users/Samsung/code/cacp/client/components/modals/NominationModal.js"],"names":["React","useState","useEffect","Modal","NominationForm","connect","Web3","ProposalForm","NominationModal","parcel","props","userManaBalance","getCurrentProp","drizzleState","drizzle","show","setShow","handleShow","handleClose","tokenId","setTokenId","currentProp","setCurrentProp","myHeaders","Headers","append","fetchDetailsLink","graphql","JSON","stringify","query","x","y","proxyUrl","targetUrl","fetch","method","headers","body","variables","redirect","then","res","json","result","parcelData","data","parcels","contracts","ProposalController","methods","getPropTokenIdMap","call","proposalAddress","publication","price","mapStateToProps","state","propAddress","appReducers","mapDispatchToProps","dispatch","type","getTokenId"],"mappings":"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","sourcesContent":["  \r\nimport React, { useState, useEffect } from 'react';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport NominationForm from '../forms/NominationForm';\r\nimport { connect } from 'react-redux';\r\nimport Web3 from 'web3';\r\nimport ProposalForm from '../forms/ProposalForm';\r\n\r\n\r\nconst NominationModal = ({ parcel, props, userManaBalance, getCurrentProp }) => {\r\n\r\n  const {drizzleState, drizzle} = props;\r\n\r\n  const [show, setShow] = useState(false);\r\n  const handleShow = () => setShow(true);\r\n  const handleClose = () => setShow(false);\r\n  const [tokenId, setTokenId] = useState(null);\r\n  const [currentProp, setCurrentProp] = useState(null);\r\n\r\n  const myHeaders = new Headers();\r\n  myHeaders.append(\"Content-Type\", \"application/json\");\r\n\r\n  useEffect(() => {\r\n  const fetchDetailsLink = async () => {\r\n\r\n  const graphql= JSON.stringify({ query: \r\n  `{ parcels(where: {x:\"${parcel.x}\",y:\"${parcel.y}\"}) { tokenId }}`\r\n})\r\n\r\n  const proxyUrl = 'https://cors-anywhere.herokuapp.com/',\r\n  targetUrl = 'https://api.thegraph.com/subgraphs/name/decentraland/marketplace'\r\n\r\n  fetch(proxyUrl + targetUrl, {\r\n    method: \"POST\",\r\n    headers:myHeaders,  \r\n    body:graphql, variables:{},\r\n    redirect: 'follow'\r\n  })\r\n    .then(res => res.json())\r\n    .then((result) => {\r\n      const parcelData = result.data.parcels[0];\r\n      return parcelData;\r\n    })\r\n    .then((result) => { \r\n      const { tokenId } = result;\r\n     setTokenId(tokenId);\r\n     return tokenId;\r\n    })\r\n    .then(async (tokenId) => {\r\n      const proposalAddress = await drizzle.contracts.ProposalController.methods.getPropTokenIdMap(`${tokenId}`).call(); \r\n      getCurrentProp(proposalAddress);\r\n      setCurrentProp(proposalAddress);\r\n    })\r\n  };\r\nfetchDetailsLink();\r\n\r\n}, []);\r\n\r\n\r\nreturn (   \r\n      <> \r\n        <button type=\"button\" className=\"btn btn-lg btn-block card-footer-btn\" onClick={handleShow}>\r\n          Nominate Asset\r\n        </button>\r\n        <Modal className=\"nomintation-modal\" show={show} onHide={handleClose}>\r\n          <Modal.Header className=\"text-center justify-content-center\" closeButton>\r\n            <Modal.Title className=\"text-center justify-content-center\">Current Price:&nbsp;{parcel.publication.price}&nbsp;MANA\r\n            <p className=\"mana-balance mb-1\" >Your MANA Balance:&nbsp;{`${userManaBalance}`}</p>\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n          <Modal.Body className=\"pt-1\">\r\n          <ProposalForm                  \r\n            assetPrice={parcel.publication.price}  \r\n            props={props}\r\n            drizzle={drizzle}\r\n            drizzleState={drizzleState}\r\n            tokenId={tokenId}\r\n            userManaBalance={userManaBalance}\r\n            propasalContractAddr={currentProp}\r\n            /> \r\n          </Modal.Body>\r\n        </Modal>\r\n        <style jsx>\r\n          {`  .nomintation-modal{font-family: Poppins;}\r\n              .mana-balance{font-size:.9rem;color:#66a3ff;font-weight: 200;text-align:left}\r\n          `}                \r\n        </style>\r\n      </>\r\n        );    \r\n      } \r\n        const mapStateToProps = (state) => ({\r\n          propAddress: state.appReducers.propAddress,\r\n        })\r\n        \r\n        const mapDispatchToProps = (dispatch) => ({\r\n          getCurrentProp: (proposalAddress) =>  dispatch({ type: \"GOT_PROP_ADDRESS\", proposalAddress:proposalAddress }),\r\n          getTokenId: (tokenId) =>  dispatch({ type: \"SET_TOKEN_ID\", tokenId:tokenId })\r\n        });\r\n        \r\n        \r\nexport default connect(mapStateToProps, mapDispatchToProps)(NominationModal);\r\n     "]},"metadata":{},"sourceType":"module"}