{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Samsung\\\\code\\\\cacp\\\\client\\\\components\\\\forms\\\\ProposalForm.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { Loader } from 'rimble-ui';\nimport InitialContributeModal from '../modals/InitialContibModal';\nimport InnerPropForm from './InnerPropForm';\nimport { newContextComponents } from \"@drizzle/react-components\";\nconst ContractData = newContextComponents.ContractData,\n      ContractForm = newContextComponents.ContractForm;\n\nconst ProposalForm = ({\n  drizzle,\n  drizzleState,\n  props,\n  getCurrentProp,\n  tokenId,\n  assetPrice,\n  userManaBalance,\n  expiresAt,\n  nftAddress,\n  gotApprovedBalance,\n  orderId,\n  orderStatus\n}) => {\n  _s();\n\n  const _useState = useState(null),\n        currentProp = _useState[0],\n        setCurrentProp = _useState[1];\n\n  const _useState2 = useState(null),\n        currentApproval = _useState2[0],\n        setCurrentApproval = _useState2[1];\n\n  const fetchProposalAddress = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var proposalAddress, account, manaContract, approvedAmount;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return drizzle.contracts.ProposalController.methods.getPropTokenIdMap(\"\".concat(tokenId)).call();\n\n          case 2:\n            proposalAddress = _context.sent;\n            setCurrentProp(proposalAddress);\n            getCurrentProp(proposalAddress);\n            account = drizzleState.accounts[0];\n            manaContract = drizzle.contracts.MANAToken;\n            _context.next = 9;\n            return manaContract.methods.allowance(account, proposalAddress).call();\n\n          case 9:\n            approvedAmount = _context.sent;\n            setCurrentApproval(approvedAmount);\n            gotApprovedBalance(approvedAmount);\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n\n    return function fetchProposalAddress() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(() => {\n    fetchProposalAddress();\n  }, [currentProp || currentApproval]);\n\n  if (!currentProp) {\n    return __jsx(\"div\", {\n      className: \"align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 5\n      }\n    }, currentProp, \" ProposalForm 25\", __jsx(Loader, {\n      className: \"mx-auto\",\n      color: \"#007bff\",\n      size: \"40px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  if (currentProp) {\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 4\n      }\n    }, __jsx(InnerPropForm, {\n      assetPrice: assetPrice,\n      expiresAt: expiresAt,\n      nftAddress: nftAddress,\n      props: props,\n      drizzle: drizzle,\n      drizzleState: drizzleState,\n      tokenId: tokenId,\n      orderId: orderId,\n      userManaBalance: userManaBalance,\n      orderStatus: orderStatus,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 5\n      }\n    }));\n  } else {\n    __jsx(\"div\", {\n      className: \"align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 5\n      }\n    }, currentProp, \" ProposalForm 44\", __jsx(Loader, {\n      className: \"mx-auto\",\n      color: \"#007bff\",\n      size: \"40px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 7\n      }\n    }));\n  }\n};\n\n_s(ProposalForm, \"9Maf6Hcz52jsoRZ6DK2ZV3kPZZU=\");\n\n_c = ProposalForm;\n\nconst mapDispatchToProps = dispatch => ({\n  getCurrentProp: proposalAddress => dispatch({\n    type: \"GOT_PROP_ADDRESS\",\n    proposalAddress: proposalAddress\n  }),\n  gotApprovedBalance: approvedAmount => dispatch({\n    type: 'APROVED_AMOUNT',\n    approvedAmount: approvedAmount\n  })\n});\n\nexport default connect(null, mapDispatchToProps)(ProposalForm);\n\nvar _c;\n\n$RefreshReg$(_c, \"ProposalForm\");","map":{"version":3,"sources":["C:/Users/Samsung/code/cacp/client/components/forms/ProposalForm.js"],"names":["React","useState","useEffect","connect","Loader","InitialContributeModal","InnerPropForm","newContextComponents","ContractData","ContractForm","ProposalForm","drizzle","drizzleState","props","getCurrentProp","tokenId","assetPrice","userManaBalance","expiresAt","nftAddress","gotApprovedBalance","orderId","orderStatus","currentProp","setCurrentProp","currentApproval","setCurrentApproval","fetchProposalAddress","contracts","ProposalController","methods","getPropTokenIdMap","call","proposalAddress","account","accounts","manaContract","MANAToken","allowance","approvedAmount","mapDispatchToProps","dispatch","type"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,MAAT,QAAuB,WAAvB;AACA,OAAOC,sBAAP,MAAmC,8BAAnC;AACA,OAAOC,aAAP,MAA2B,iBAA3B;AACA,SAASC,oBAAT,QAAqC,2BAArC;MACQC,Y,GAA+BD,oB,CAA/BC,Y;MAAcC,Y,GAAiBF,oB,CAAjBE,Y;;AAEtB,MAAMC,YAAY,GAAG,CAAC;AAAEC,EAAAA,OAAF;AAAWC,EAAAA,YAAX;AAAyBC,EAAAA,KAAzB;AAAgCC,EAAAA,cAAhC;AAAgDC,EAAAA,OAAhD;AAAyDC,EAAAA,UAAzD;AAAqEC,EAAAA,eAArE;AAAqFC,EAAAA,SAArF;AAAgGC,EAAAA,UAAhG;AAA4GC,EAAAA,kBAA5G;AAAgIC,EAAAA,OAAhI;AAAyIC,EAAAA;AAAzI,CAAD,KAA4J;AAAA;;AAAA,oBAE3IrB,QAAQ,CAAC,IAAD,CAFmI;AAAA,QAE1KsB,WAF0K;AAAA,QAE7JC,cAF6J;;AAAA,qBAGnIvB,QAAQ,CAAC,IAAD,CAH2H;AAAA,QAG1KwB,eAH0K;AAAA,QAGzJC,kBAHyJ;;AAKjL,QAAMC,oBAAoB;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACGhB,OAAO,CAACiB,SAAR,CAAkBC,kBAAlB,CAAqCC,OAArC,CAA6CC,iBAA7C,WAAkEhB,OAAlE,GAA6EiB,IAA7E,EADH;;AAAA;AACrBC,YAAAA,eADqB;AAE3BT,YAAAA,cAAc,CAACS,eAAD,CAAd;AACAnB,YAAAA,cAAc,CAACmB,eAAD,CAAd;AAEMC,YAAAA,OALqB,GAKXtB,YAAY,CAACuB,QAAb,CAAsB,CAAtB,CALW;AAMrBC,YAAAA,YANqB,GAMNzB,OAAO,CAACiB,SAAR,CAAkBS,SANZ;AAAA;AAAA,mBAOED,YAAY,CAACN,OAAb,CAAqBQ,SAArB,CAA+BJ,OAA/B,EAAuCD,eAAvC,EAAwDD,IAAxD,EAPF;;AAAA;AAOrBO,YAAAA,cAPqB;AAQ3Bb,YAAAA,kBAAkB,CAACa,cAAD,CAAlB;AACAnB,YAAAA,kBAAkB,CAACmB,cAAD,CAAlB;;AAT2B;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAApBZ,oBAAoB;AAAA;AAAA;AAAA,KAA1B;;AAYAzB,EAAAA,SAAS,CAAC,MAAM;AACdyB,IAAAA,oBAAoB;AACrB,GAFQ,EAEN,CAACJ,WAAW,IAAIE,eAAhB,CAFM,CAAT;;AAKA,MAAG,CAACF,WAAJ,EAAgB;AACd,WACE;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGA,WADH,sBAEE,MAAC,MAAD;AAAQ,MAAA,SAAS,EAAC,SAAlB;AAA4B,MAAA,KAAK,EAAC,SAAlC;AAA4C,MAAA,IAAI,EAAC,MAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADF;AAMC;;AACH,MAAGA,WAAH,EAAe;AACd,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACC,MAAC,aAAD;AACE,MAAA,UAAU,EAAEP,UADd;AAEE,MAAA,SAAS,EAAEE,SAFb;AAGE,MAAA,UAAU,EAAEC,UAHd;AAIE,MAAA,KAAK,EAAEN,KAJT;AAKE,MAAA,OAAO,EAAEF,OALX;AAME,MAAA,YAAY,EAAEC,YANhB;AAOE,MAAA,OAAO,EAAEG,OAPX;AAQE,MAAA,OAAO,EAAEM,OARX;AASE,MAAA,eAAe,EAAEJ,eATnB;AAUE,MAAA,WAAW,EAAEK,WAVf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CADF;AAgBE,GAjBH,MAkBM;AACF;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGC,WADH,sBAEE,MAAC,MAAD;AAAQ,MAAA,SAAS,EAAC,SAAlB;AAA4B,MAAA,KAAK,EAAC,SAAlC;AAA4C,MAAA,IAAI,EAAC,MAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF;AAID;AACF,CAtDD;;GAAMb,Y;;KAAAA,Y;;AAwDN,MAAM8B,kBAAkB,GAAIC,QAAD,KAAe;AACxC3B,EAAAA,cAAc,EAAGmB,eAAD,IAAsBQ,QAAQ,CAAC;AAAEC,IAAAA,IAAI,EAAE,kBAAR;AAA4BT,IAAAA,eAAe,EAACA;AAA5C,GAAD,CADN;AAExCb,EAAAA,kBAAkB,EAAGmB,cAAD,IAAoBE,QAAQ,CAAC;AAAEC,IAAAA,IAAI,EAAC,gBAAP;AAAyBH,IAAAA,cAAc,EAACA;AAAxC,GAAD;AAFR,CAAf,CAA3B;;AAMA,eAAepC,OAAO,CAAC,IAAD,EAAOqC,kBAAP,CAAP,CAAkC9B,YAAlC,CAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Loader } from 'rimble-ui';\r\nimport InitialContributeModal from '../modals/InitialContibModal';\r\nimport InnerPropForm  from './InnerPropForm'\r\nimport { newContextComponents } from \"@drizzle/react-components\";\r\nconst { ContractData, ContractForm } = newContextComponents;\r\n\r\nconst ProposalForm = ({ drizzle, drizzleState, props, getCurrentProp, tokenId, assetPrice, userManaBalance,expiresAt, nftAddress, gotApprovedBalance, orderId, orderStatus }) => {     \r\n\r\nconst [currentProp, setCurrentProp] = useState(null);\r\nconst [currentApproval, setCurrentApproval] = useState(null);\r\n\r\nconst fetchProposalAddress = async () => {\r\n  const proposalAddress = await drizzle.contracts.ProposalController.methods.getPropTokenIdMap(`${tokenId}`).call(); \r\n  setCurrentProp(proposalAddress);\r\n  getCurrentProp(proposalAddress);\r\n\r\n  const account = drizzleState.accounts[0];\r\n  const manaContract = drizzle.contracts.MANAToken; \r\n  const approvedAmount = await manaContract.methods.allowance(account,proposalAddress).call();\r\n  setCurrentApproval(approvedAmount)\r\n  gotApprovedBalance(approvedAmount);\r\n}\r\n\r\nuseEffect(() => {\r\n  fetchProposalAddress();\r\n}, [currentProp || currentApproval]);\r\n   \r\n\r\nif(!currentProp){\r\n  return (\r\n    <div className=\"align-items-center\"> \r\n      {currentProp} ProposalForm 25  \r\n      <Loader className=\"mx-auto\" color=\"#007bff\" size=\"40px\" />\r\n    </div>\r\n    )\r\n  }\r\nif(currentProp){\r\n return (\r\n   <div>      \r\n    <InnerPropForm\r\n      assetPrice={assetPrice}  \r\n      expiresAt={expiresAt}\r\n      nftAddress={nftAddress}\r\n      props={props}\r\n      drizzle={drizzle}\r\n      drizzleState={drizzleState}\r\n      tokenId={tokenId}\r\n      orderId={orderId}\r\n      userManaBalance={userManaBalance}\r\n      orderStatus={orderStatus}\r\n    /> \r\n    </div>\r\n    )\r\n  }\r\n  else{\r\n    <div className=\"align-items-center\"> \r\n      {currentProp} ProposalForm 44  \r\n      <Loader className=\"mx-auto\" color=\"#007bff\" size=\"40px\" />\r\n    </div>\r\n  }  \r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  getCurrentProp: (proposalAddress) =>  dispatch({ type: \"GOT_PROP_ADDRESS\", proposalAddress:proposalAddress }),\r\n  gotApprovedBalance: (approvedAmount) => dispatch({ type:'APROVED_AMOUNT', approvedAmount:approvedAmount }),\r\n});\r\n      \r\n      \r\nexport default connect(null, mapDispatchToProps)(ProposalForm);"]},"metadata":{},"sourceType":"module"}