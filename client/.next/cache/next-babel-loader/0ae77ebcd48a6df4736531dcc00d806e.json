{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dev_Account\\\\dnp\\\\client\\\\components\\\\forms\\\\InterMediateForm.js\";\nvar __jsx = React.createElement;\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport SellAsset from './SellAsset.js';\nimport SecondSellAsset from './SecondSellAsset.js';\nimport Purchase from './Purchase.js';\nimport ContributeForm from './ContributeForm';\nimport { Loader } from 'rimble-ui';\nimport ForSaleInnerModal from '../modals/ForSaleInnerModal.js';\nimport AwardAsset from '../modals/AwardAssetModal.js';\nimport SoldAsset from './SoldAsset.js';\nimport WithDraw from '../buttons/WithDrawBtn';\nimport moment from \"moment\";\n\nconst InterMediateForm = ({\n  drizzle,\n  drizzleState,\n  assetPrice,\n  propAddress,\n  tokenId,\n  soldStatus,\n  proposalBalance,\n  orderStatus,\n  depositAmount,\n  orderId,\n  storedOrderId,\n  prevOrderStatus\n}) => {\n  const nowUnix = moment().valueOf();\n\n  const _useState = useState(null),\n        status = _useState[0],\n        setProposalSatus = _useState[1];\n\n  const _useState2 = useState(null),\n        saleExpiration = _useState2[0],\n        setSaleExpiration = _useState2[1];\n\n  useEffect(() => {\n    fetchProposalStatus();\n  }, [propAddress]);\n\n  const fetchProposalStatus = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var contract, reSaleExpiresAt, dataKey;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            contract = drizzle.contracts[\"\".concat(propAddress)];\n            _context.next = 3;\n            return contract.methods.reSaleExpiresAt().call();\n\n          case 3:\n            reSaleExpiresAt = _context.sent;\n            dataKey = contract.methods['proposals'].cacheCall(tokenId);\n            setSaleExpiration(reSaleExpiresAt);\n            setProposalSatus(dataKey);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n\n    return function fetchProposalStatus() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  const propContracts = drizzleState.contracts[\"\".concat(propAddress)]; //0-FUNDING, 1-FUNDED, 2-WITHDRAWING, 3-PURCHASED, 4-FOR_SALE, 5-SOLD, 6-PAYINGOUT, 7-PAIDOUT, 8-EXPIRED, 9-SALE_FAILED, 10-AWARDED\n\n  if (propContracts.proposals[status]) {\n    const displayData = propContracts.proposals[status];\n    const proposalStatus = displayData && displayData.value.status; //TESTING AWARDASSET\n    //const proposalStatus = '10';\n\n    if (proposalStatus.toString() === '0' && orderStatus === 'open') {\n      //0-FUNDING\n      return __jsx(React.Fragment, null, __jsx(ContributeForm, {\n        drizzle: drizzle,\n        drizzleState: drizzleState,\n        assetPrice: assetPrice,\n        propAddress: propAddress,\n        tokenId: tokenId,\n        orderStatus: orderStatus,\n        prevOrderStatus: prevOrderStatus,\n        orderId: orderId,\n        storedOrderId: storedOrderId,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 15\n        }\n      }));\n    } else if (proposalStatus.toString() === '0' && orderStatus === 'cancelled') {\n      return __jsx(\"div\", {\n        className: \"modal-body text-deposit-complete justify-content-center px-1 py-1s\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 9\n        }\n      }, depositAmount > 0 ? __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 13\n        }\n      }, __jsx(\"div\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 15\n        }\n      }, \"Sale cancelled. Click to withdraw your MANA.\"), __jsx(WithDraw, {\n        depositAmount: depositAmount,\n        drizzleState: drizzleState,\n        drizzle: drizzle,\n        propAddress: propAddress,\n        prevOrderStatus: prevOrderStatus,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 15\n        }\n      })) : __jsx(\"div\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }\n      }, \"You did not contribute to this DNA.\"));\n    } else if (proposalStatus.toString() === '1') {\n      //FUNDED\n      return __jsx(\"div\", {\n        className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 7\n        }\n      }, __jsx(Purchase, {\n        drizzle: drizzle,\n        drizzleState: drizzleState,\n        assetPrice: assetPrice,\n        propAddress: propAddress,\n        tokenId: tokenId,\n        prevOrderStatus: prevOrderStatus,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 9\n        }\n      }));\n    } else if (proposalStatus.toString() === '2') {\n      //WITHDRAWING\n      return __jsx(React.Fragment, null, __jsx(\"div\", {\n        className: \"mx-auto modal-body justify-content-center px-1 py-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 10\n        }\n      }, __jsx(\"p\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }\n      }, \"Withdrawal in progress...\"), __jsx(Loader, {\n        className: \"mx-auto\",\n        color: \"#007bff\",\n        size: \"40px\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }\n      })));\n    } else if (proposalStatus.toString() === '3' && orderStatus === 'open') {\n      //PURCHASED ********double check if resal failed orderStatus would be cancelled or sold\n      return __jsx(\"div\", {\n        className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 9\n        }\n      }, __jsx(SellAsset, {\n        drizzle: drizzle,\n        drizzleState: drizzleState,\n        propAddress: propAddress,\n        tokenId: tokenId,\n        prevOrderStatus: prevOrderStatus,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }\n      }));\n    } //Second Sale attempt\n    else if (proposalStatus.toString() === '4' && orderStatus === 'cancelled') {\n        return __jsx(React.Fragment, null, console.log(proposalStatus), __jsx(\"div\", {\n          className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 11\n          }\n        }, __jsx(\"div\", {\n          className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 15\n          }\n        }, __jsx(SecondSellAsset, {\n          drizzle: drizzle,\n          drizzleState: drizzleState,\n          propAddress: propAddress,\n          tokenId: tokenId,\n          prevOrderStatus: prevOrderStatus,\n          orderStatus: orderStatus,\n          proposalStatus: proposalStatus,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 17\n          }\n        }))));\n      } else if (proposalStatus.toString() === '4' && orderStatus !== 'sold') {\n        //FOR_SALE\n        return __jsx(React.Fragment, null, __jsx(\"div\", {\n          className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 11\n          }\n        }, __jsx(ForSaleInnerModal, {\n          drizzle: drizzle,\n          drizzleState: drizzleState,\n          propAddress: propAddress,\n          prevOrderStatus: prevOrderStatus,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }\n        })));\n      } else if (proposalStatus.toString() === '10' && orderStatus === 'cancelled') {\n        return __jsx(React.Fragment, null, __jsx(\"div\", {\n          className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 11\n          }\n        }, __jsx(AwardAsset, {\n          drizzle: drizzle,\n          drizzleState: drizzleState,\n          propAddress: propAddress,\n          tokenId: tokenId,\n          prevOrderStatus: prevOrderStatus,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }\n        })));\n      } //SOLD & Paying out\n      else if (proposalStatus.toString() === '6' || orderStatus === 'sold') {\n          return __jsx(React.Fragment, null, __jsx(\"div\", {\n            className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 11\n            }\n          }, proposalBalance !== null ? __jsx(SoldAsset, {\n            drizzle: drizzle,\n            drizzleState: drizzleState,\n            propAddress: propAddress,\n            tokenId: tokenId,\n            proposalBalance: proposalBalance,\n            prevOrderStatus: prevOrderStatus,\n            startPay: true,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 15\n            }\n          }) : console.log('Loading...')));\n        } else if (proposalStatus.toString() === '7') {\n          //PaidOut\n          return __jsx(\"div\", {\n            className: \"modal-body text-deposit-complete justify-content-center px-1 py-1\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 9\n            }\n          }, __jsx(\"p\", {\n            className: \"text-center\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 11\n            }\n          }, \"DNA Sold and Payout Complete\"));\n        }\n  } else {\n    return __jsx(\"div\", {\n      className: \"mx-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 7\n      }\n    }, __jsx(Loader, {\n      className: \"mx-auto\",\n      color: \"#007bff\",\n      size: \"40px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }\n    }));\n  }\n};\n\nconst mapStateToProps = state => ({\n  soldStatus: state.appReducers.status,\n  proposalBalance: state.appReducers.proposalBalance,\n  depositAmount: state.appReducers.depositAmount\n});\n\nexport default connect(mapStateToProps, null)(InterMediateForm);","map":{"version":3,"sources":["C:/Users/Dev_Account/dnp/client/components/forms/InterMediateForm.js"],"names":["React","useEffect","useState","connect","SellAsset","SecondSellAsset","Purchase","ContributeForm","Loader","ForSaleInnerModal","AwardAsset","SoldAsset","WithDraw","moment","InterMediateForm","drizzle","drizzleState","assetPrice","propAddress","tokenId","soldStatus","proposalBalance","orderStatus","depositAmount","orderId","storedOrderId","prevOrderStatus","nowUnix","valueOf","status","setProposalSatus","saleExpiration","setSaleExpiration","fetchProposalStatus","contract","contracts","methods","reSaleExpiresAt","call","dataKey","cacheCall","propContracts","proposals","displayData","proposalStatus","value","toString","console","log","mapStateToProps","state","appReducers"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport SellAsset from './SellAsset.js';\r\nimport SecondSellAsset from './SecondSellAsset.js';\r\nimport Purchase from './Purchase.js';\r\nimport ContributeForm from './ContributeForm';\r\nimport { Loader } from 'rimble-ui';\r\nimport ForSaleInnerModal from '../modals/ForSaleInnerModal.js';\r\nimport AwardAsset from '../modals/AwardAssetModal.js';\r\nimport SoldAsset from './SoldAsset.js';\r\nimport WithDraw from '../buttons/WithDrawBtn';\r\nimport moment from \"moment\";\r\n\r\nconst InterMediateForm = ({ drizzle, drizzleState, assetPrice, propAddress, tokenId, soldStatus, proposalBalance, orderStatus, depositAmount, orderId, storedOrderId, prevOrderStatus }) => {     \r\n  const nowUnix = moment().valueOf();\r\n  const [status, setProposalSatus] = useState(null);\r\n  const [saleExpiration, setSaleExpiration] = useState(null);\r\n\r\n    useEffect(() => {\r\n      fetchProposalStatus();\r\n    }, [propAddress])\r\n\r\n    const fetchProposalStatus = async () => { \r\n      const contract = drizzle.contracts[`${propAddress}`];\r\n      const reSaleExpiresAt = await contract.methods.reSaleExpiresAt().call();\r\n      const dataKey = contract.methods['proposals'].cacheCall(tokenId);\r\n      setSaleExpiration(reSaleExpiresAt);\r\n      setProposalSatus(dataKey);  \r\n    }\r\n\r\n    const propContracts = drizzleState.contracts[`${propAddress}`];\r\n    \r\n    //0-FUNDING, 1-FUNDED, 2-WITHDRAWING, 3-PURCHASED, 4-FOR_SALE, 5-SOLD, 6-PAYINGOUT, 7-PAIDOUT, 8-EXPIRED, 9-SALE_FAILED, 10-AWARDED\r\n    if(propContracts.proposals[status]) {\r\n      const displayData = propContracts.proposals[status]; \r\n      const proposalStatus =  displayData && displayData.value.status;\r\n      //TESTING AWARDASSET\r\n      //const proposalStatus = '10';\r\n    \r\n    if(proposalStatus.toString() === '0' && orderStatus === 'open'){\r\n    //0-FUNDING\r\n    return (\r\n            <>\r\n              <ContributeForm drizzle={drizzle} drizzleState={drizzleState} assetPrice={assetPrice} propAddress={propAddress} tokenId={tokenId} orderStatus={orderStatus} prevOrderStatus={prevOrderStatus} orderId={orderId} storedOrderId={storedOrderId} />\r\n            </>\r\n      )\r\n    }\r\n    else if(proposalStatus.toString() === '0' && orderStatus === 'cancelled') {\r\n      return (\r\n        <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1s\">\r\n          {depositAmount > 0  ?\r\n            <div>\r\n              <div className=\"text-center\">\r\n                Sale cancelled. Click to withdraw your MANA.\r\n              </div>  \r\n              <WithDraw \r\n                depositAmount={depositAmount} \r\n                drizzleState={drizzleState} \r\n                drizzle={drizzle} \r\n                propAddress={propAddress} \r\n                prevOrderStatus={prevOrderStatus}\r\n              />\r\n            </div>\r\n          :\r\n            <div className=\"text-center\">\r\n              You did not contribute to this DNA.\r\n            </div>  \r\n          }\r\n        </div>\r\n      ) \r\n    }\r\n  else if(proposalStatus.toString() === '1') {\r\n     //FUNDED\r\n    return (\r\n      <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n        <Purchase drizzle={drizzle} drizzleState={drizzleState} assetPrice={assetPrice} propAddress={propAddress} tokenId={tokenId} prevOrderStatus={prevOrderStatus} />\r\n      </div>\r\n    )\r\n      \r\n    }\r\n    else if(proposalStatus.toString() === '2') {\r\n      //WITHDRAWING\r\n      return  (\r\n        <>\r\n         <div className=\"mx-auto modal-body justify-content-center px-1 py-1\"> \r\n          <p className=\"text-center\">\r\n            Withdrawal in progress...\r\n          </p>  \r\n            <Loader className=\"mx-auto\" color=\"#007bff\" size=\"40px\" />\r\n        </div>\r\n        </>\r\n      )\r\n    }\r\n    else if(proposalStatus.toString() === '3' && orderStatus === 'open') {\r\n      //PURCHASED ********double check if resal failed orderStatus would be cancelled or sold\r\n      return  (\r\n        <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n          <SellAsset drizzle={drizzle} drizzleState={drizzleState} propAddress={propAddress} tokenId={tokenId} prevOrderStatus={prevOrderStatus} />\r\n        </div>\r\n      )  \r\n    }\r\n    //Second Sale attempt\r\n    else if(proposalStatus.toString() === '4' && orderStatus === 'cancelled') {\r\n      return  (\r\n        <>{console.log(proposalStatus)}\r\n          <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n              <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n                <SecondSellAsset \r\n                  drizzle={drizzle} \r\n                  drizzleState={drizzleState} \r\n                  propAddress={propAddress} \r\n                  tokenId={tokenId} \r\n                  prevOrderStatus={prevOrderStatus} \r\n                  orderStatus={orderStatus} \r\n                  proposalStatus={proposalStatus} \r\n                />\r\n              </div>\r\n          </div>     \r\n        </>\r\n      )   \r\n    }\r\n    else if(proposalStatus.toString() === '4' && orderStatus !== 'sold') {\r\n      //FOR_SALE\r\n      return  (\r\n        <>\r\n          <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n            <ForSaleInnerModal \r\n              drizzle={drizzle}\r\n              drizzleState={drizzleState} \r\n              propAddress={propAddress}\r\n              prevOrderStatus={prevOrderStatus}\r\n            />\r\n          </div>     \r\n        </>\r\n      )   \r\n    }\r\n    else if(proposalStatus.toString() === '10' && orderStatus === 'cancelled') {\r\n      return  (\r\n        <>\r\n          <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n            <AwardAsset \r\n              drizzle={drizzle}\r\n              drizzleState={drizzleState} \r\n              propAddress={propAddress}\r\n              tokenId={tokenId}\r\n              prevOrderStatus={prevOrderStatus}\r\n            />\r\n          </div>     \r\n        </>\r\n      )   \r\n    }\r\n    //SOLD & Paying out\r\n    else if(proposalStatus.toString() === '6' || orderStatus === 'sold') {\r\n      return  (\r\n        <>\r\n          <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n            {proposalBalance !== null ?\r\n              <SoldAsset \r\n                drizzle={drizzle} \r\n                drizzleState={drizzleState} \r\n                propAddress={propAddress} \r\n                tokenId={tokenId}  \r\n                proposalBalance={proposalBalance}\r\n                prevOrderStatus={prevOrderStatus}\r\n                startPay = {true}\r\n              />\r\n            :\r\n              console.log('Loading...')\r\n            }\r\n          </div>\r\n        </>\r\n      )  \r\n    }\r\n    else if(proposalStatus.toString() === '7') {\r\n      //PaidOut\r\n      return  (\r\n        <div className=\"modal-body text-deposit-complete justify-content-center px-1 py-1\">\r\n          <p className=\"text-center\">\r\n            DNA Sold and Payout Complete\r\n          </p>\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n  else {\r\n    return (\r\n      <div className=\"mx-auto\">   \r\n        <Loader className=\"mx-auto\" color=\"#007bff\" size=\"40px\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  soldStatus: state.appReducers.status,\r\n  proposalBalance: state.appReducers.proposalBalance,\r\n  depositAmount:state.appReducers.depositAmount\r\n})\r\n\r\nexport default connect(mapStateToProps, null)(InterMediateForm);"]},"metadata":{},"sourceType":"module"}